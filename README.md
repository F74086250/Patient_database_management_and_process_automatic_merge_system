# 手術患者資料庫管理&流程化自動整合系統

> #### 計畫名稱:003 高齡癌症手術患者健康照護及睡眠品質及其機制探索
>
> #### 負責醫師:國立成功大學醫學系 麻醉科副教授 曾稼志醫師
>
> #### 合作教授:國立成功大學資訊工程學系(所)/醫學資訊研究所 梁勝富教授
>
> #### 程式作者:國立成功大學資訊工程學系 112 級大學部學生 莊上緣

## 開發動機

> #### 在計畫內的收案病患資料中，每位病患在進行麻醉治療時，會有不同的臨床機器去蒐集病患隨時間變化的各種體徵，會分成 trends.asc CCO.csv ANI.log 以及麻醉記事本等檔案，CCO 與 ANI 之時間戳記各自與麻醉機的時間有落差，必須按照麻醉記事本內的紀錄去對時間進行調整，而 trends,CCO,ANI 等資料都為一分鐘內有好多筆，其中有許多資料因為儀器暖機或是訊號不穩定等因素，會有缺失及離群值，因此我必須設計一套系統可以對這些資料自動進行缺失補齊、移除噪訊、時間平移、每分鐘資料平均以及 outer join，讓每位病患都有一個標準且規格化、可供 data analysis 或是 AI model training 的整合資料集

## 系統架構圖

:::info
![](https://i.imgur.com/ViovcbT.jpg)
:::

## 軟硬體

> #### 病房內之體徵紀錄儀、曾醫師辦公室電腦之 S5 collect(為將 S5 資料轉成 trends.asc 的轉換軟體)

## 開發環境與主要套件(OS:win10)

> #### python 3.8.0
>
> #### pyQt5 5.15.6
>
> #### pandas 1.4.2

## 應用技術

> #### python GUI design
>
> #### pandas 資料分析
>
> #### 資料庫 CRUD
>
> #### python 多執行序介面撰寫
>
> #### 時間序列資料處理(timestamp)

## 軟體版本演進及改良

:::info
![](https://i.imgur.com/sYkvL1l.jpg)
:::

## 心得

**原本的資料，若是透過人工在 excel 進行 outlier remove，缺漏時間補齊與每分鐘平均並進行 outer join，要整合好一位病患的資料，有可能得花上幾十分鐘(主要都花在 outlier remove，由於資料量很大，且病患的 attribute 有很多)，但是經由流程化控制後，進行批次處理的時間大幅縮短，可在幾分鐘內就將數十位病患的資料全部整合完畢。**
**此次作業除了應用到 GUI 撰寫之外，還有應用到我在三年級下學期學到的資料庫系統之概念，比如 nature join，reference 等等，並且我還運用在三年級上學期學到的 thread 的概念來實際解決了程式卡頓閃退的問題。透過實作，讓我對於曾經學過之理論有了更深刻的理解。**
